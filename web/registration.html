<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>ECASLab</title>

    <!-- Bootstrap Core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    
    <link rel='stylesheet' id='google-fonts-carme-css' href='https://fonts.googleapis.com/css?family=Carme&#038;ver=3.9.2' type='text/css' media='all' />
    <link rel='stylesheet' id='google-fonts-montserrat-alternates-css' href='https://fonts.googleapis.com/css?family=Montserrat+Alternates&#038;ver=3.9.2' type='text/css' media='all' />
    
    <link rel="stylesheet" href="ophidia.css" type="text/css" />
    
    <script>
    
	function captcha() {
		
		document.getElementById("form").reset();
		
	    var alpha = new Array('1','2','3','4','5','6','7','8','9','A','B','C','D','E','F','G','H','J','K','M','N','P','Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f','g','h','i','j','k','m','n','o','p','q','r','s','t','u','v','w','x','y','z');
	    var i;
	    for (i = 0; i < 6; i++){
	    	
	    	var a = alpha[Math.floor(Math.random() * alpha.length)];
	    	var b = alpha[Math.floor(Math.random() * alpha.length)];
	        var c = alpha[Math.floor(Math.random() * alpha.length)];
	        var d = alpha[Math.floor(Math.random() * alpha.length)];
	        var e = alpha[Math.floor(Math.random() * alpha.length)];
	        var f = alpha[Math.floor(Math.random() * alpha.length)];
	        var g = alpha[Math.floor(Math.random() * alpha.length)];
	      
	    }
	    
	    var code = a + ' ' + b + ' ' + c + ' '  + d + ' '  + e + ' '  + f + ' '  + g + ' ' ;
	    document.getElementById("mainCaptcha").value = code;
	    
	    $(this).scrollTop(0);
	} 
	
	function refreshCaptcha() {
		 var alpha = new Array('1','2','3','4','5','6','7','8','9','A','B','C','D','E','F','G','H','J','K','M','N','P','Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f','g','h','i','j','k','m','n','o','p','q','r','s','t','u','v','w','x','y','z');
		    var i;
		    for (i = 0; i < 6; i++){
		    	
		    	var a = alpha[Math.floor(Math.random() * alpha.length)];
		    	var b = alpha[Math.floor(Math.random() * alpha.length)];
		        var c = alpha[Math.floor(Math.random() * alpha.length)];
		        var d = alpha[Math.floor(Math.random() * alpha.length)];
		        var e = alpha[Math.floor(Math.random() * alpha.length)];
		        var f = alpha[Math.floor(Math.random() * alpha.length)];
		        var g = alpha[Math.floor(Math.random() * alpha.length)];
		      
		    }
		    
		    var code = a + ' ' + b + ' ' + c + ' '  + d + ' '  + e + ' '  + f + ' '  + g + ' ' ;
		    document.getElementById("mainCaptcha").value = code;	
	}
	 
	function submission(){

	 	var first_name = document.getElementById("first_name").value;
		var last_name = document.getElementById("last_name").value;
		var email = document.getElementById("email").value;
		var affiliation = document.getElementById("affiliation").value;
		var motivation = document.getElementById("motivation").value;
		var newsletter = document.getElementById("newsletter").checked;
		
		var f = document.getElementsByTagName('form')[0];
		
		if(f.checkValidity()) {
			
		     var string1 = (document.getElementById('mainCaptcha').value).split(' ').join('');
		     var string2 = (document.getElementById('txtInput').value).split(' ').join('');
		     
		     if (string1 == string2) {
		    	 
		    	 document.getElementById("message").innerHTML = "<center><img src='img/loading.gif' align='middle' height='50' width='70'></center>";

					$.ajax({
				    	type: 'POST',
						url: "ophregistrationservice/insertOphUser",
						data: { 
							first_name: first_name, 
						    last_name: last_name,
						    email: email,
						    affiliation: affiliation,
						    motivation: motivation,
						    newsletter: newsletter
						},
						success: function(message){
						    
						    document.getElementById("form").reset();
							
						    var alpha = new Array('0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F','G','H','J','K','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f','g','h','i','j','k','m','n','o','p','q','r','s','t','u','v','w','x','y','z');
						    var i;
						    for (i = 0; i < 6; i++){
						    	
						    	var a = alpha[Math.floor(Math.random() * alpha.length)];
						    	var b = alpha[Math.floor(Math.random() * alpha.length)];
						        var c = alpha[Math.floor(Math.random() * alpha.length)];
						        var d = alpha[Math.floor(Math.random() * alpha.length)];
						        var e = alpha[Math.floor(Math.random() * alpha.length)];
						        var f = alpha[Math.floor(Math.random() * alpha.length)];
						        var g = alpha[Math.floor(Math.random() * alpha.length)];
						      
						    }
						    
						    var code = a + ' ' + b + ' ' + c + ' '  + d + ' '  + e + ' '  + f + ' '  + g + ' ' ;
						    document.getElementById("mainCaptcha").value = code;
						    
						    if (message == 1) 
								document.getElementById("message").innerHTML = "<p style='color:green'>Your request has been submitted. You'll receive an email to confirm the registration.</p>";
							else if (message == 0)
								document.getElementById("message").innerHTML = "<p style='color:red'>An error occurred.</p>";
							else if (message == 2)
								document.getElementById("message").innerHTML = "<p style='color:red'>E-mail already in use.</p>";
							else if (message == 3)
								document.getElementById("message").innerHTML = "<p style='color:red'>Please, fill out properly all the fields.</p>";	
						        
						},
						error: function() {
							document.getElementById("message").innerHTML = "<p style='color:red'>An error occurred.</p>";
						}
					});
		     }
		     else {
		    	 document.getElementById("message").innerHTML = "<p style='color:red'>Please, insert a valid captcha code.</p>";
		     }
		} 
		else {
			document.getElementById('message').innerHTML = "<p style='color:red'>Please, fill out properly all the fields.</p>";
		}
						 
	}
    
    </script>
</head>

<body onload="captcha();">
	
	<header id="masthead" class="site-header" role="banner">
  		<div class="header-wrap clearfix">
      		<div id="navbar" class="navbar navbar-default">
				<div class="site-branding">
					<div class="site-title">
						<a href="" target = "_blank" style="display: block; height: 100%">
       						<img class="header-image" src="img/logo-placeholder.png" alt="ECASLab Logo" width="150px">
				  			<h3>&nbsp;&nbsp;&nbsp;ECASLab</h3>
    					</a>
			  		</div>
			  	</div>
        		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
         			<span class="icon-bar"></span>
          			<span class="icon-bar"></span>
          			<span class="icon-bar"></span>
        		</button>

          		<div class="menu-main-menu-container collapse navbar-collapse nav-collapse">
            		<ul class="nav navbar-nav">
            			<li><a href="home.html" rel="nofollow">&nbsp;Home</a></li>
            			<li><a href="support.html" rel="nofollow">&nbsp;Support</a></li>
            			<li><a href="registration.html" style = "color:#333;" rel="nofollow">&nbsp;Register</a></li>
            		</ul>
      			</div>

  			</div>
		</div>
	</header>
	
    <div class="container">
    <br>
        <h1 align="center"><b>ECASLab Registration form</b></h1>
        <div class="col-md-8 col-md-offset-2">
            <div class="login-panel panel panel-default">
                <div class="panel-heading">
                    <h3 id="panel_title"><b>Sign up!</b></h3>
                </div>
                <div class="panel-body" id="panel">
                    <form id="form" onsubmit="return false">
                        <fieldset>
                            <div class="form-group">
                                <input class="form-control" maxlength="20" placeholder="First Name *" id="first_name" type="text" autofocus required>
                            </div>
                            <div class="form-group">
                                <input class="form-control" maxlength="20" placeholder="Last Name *" id="last_name" type="text" autofocus required>
                            </div>
                            <div class="form-group">
                                <input class="form-control" maxlength="60" placeholder="E-mail *" id="email" type="email" autofocus required>
                            </div>
                            <div class="form-group">
                                <input class="form-control" maxlength="90" placeholder="Affiliation *" id="affiliation" type="text" autofocus required>
                            </div>
                            <div class="form-group">
			        			<textarea class="form-control" style="resize:none" maxlength="300" placeholder="Motivation * (Research, Training, etc.)" id="motivation" rows="5" id="comment" autofocus required></textarea>
                   			</div>
                            
                            <table>
						    	<tr>
						        	<td>
						            	<label>Captcha *</label>
						           	</td>
						    	</tr>
						        <tr>
						        	<td>
						            	<input class="form-control" type="text" id="mainCaptcha" disabled/>
						             	<p>Can't read the above security code? <a href="javascript:void(0);" onclick="refreshCaptcha()">Refresh</a></p>					              		
						           	</td>
						        </tr>
						        <tr>
						          	<td>
						            	<input class="form-control" maxlength="15" type="text" id="txtInput" placeholder="Security Code *" required/>    
						          	</td>
						        </tr>
						        <tr>
						        	<td><br></td>
						        </tr>
						        <tr>
						          	<td>
										<label>
										    <input class="checkbox-inline" type="checkbox" checked="true" id="newsletter" name="newsletter"/>&nbsp;&nbsp;&nbsp;Subscribe to our Mailing List to get the latest news on EcasLab.
										</label>											
						          	</td>
						        </tr>

 							</table>
 							<br>
 							<div id="message"></div>
 							<br>
                            <button type="submit" id="submit_button" name="submit_button" class="btn btn-lg btn-success btn-block" onclick="submission()">Register</button>
                        </fieldset>
                    </form>
                    <div id="submit"></div>
                </div>
            </div>
        </div>
    </div>
    
    <footer id="colophon" class="site-footer" role="contentinfo"></footer>

    <!-- jQuery -->
    <script src="vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="vendor/metisMenu/metisMenu.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="dist/js/sb-admin-2.js"></script>

</body>

</html>